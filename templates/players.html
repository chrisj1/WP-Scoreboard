<!DOCTYPE html>
<html>
<head>
    <title>Players - {{ team_name }}</title>
    <style>
        body {
            background: transparent;
            color: #fff;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 40px auto;
            background: rgba(40,40,40,0.85);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            padding: 32px 24px;
        }
        h1 {
            text-align: center;
            font-size: 3vw;
            margin-bottom: 32px;
            letter-spacing: 2px;
        }
        .players-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 24px;
            margin-bottom: 24px;
        }
        .player-card {
            background: rgba(255,255,255,0.08);
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            padding: 18px 28px;
            min-width: 180px;
            max-width: 220px;
            text-align: center;
            font-size: 1.5vw;
        }
        .cap-number {
            font-size: 2.2vw;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 8px;
        }
        .player-name {
            font-size: 1.3vw;
            font-weight: 500;
        }
        .nav-btns {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-top: 24px;
        }
        .nav-btns button {
            background: #444;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 12px 32px;
            font-size: 1.2vw;
            cursor: pointer;
            transition: background 0.2s;
        }
        .nav-btns button:hover {
            background: #666;
        }
    </style>
    <script>
        function goToPage(page) {
            window.location.href = '/players/{{ team_name }}?page=' + page;
        }
    </script>
</head>
<body>
    <div class="container">
        <div style="display:flex;align-items:center;justify-content:center;margin-bottom:24px;gap:24px;">
            <img src="/logos/{{ team_logo }}" alt="{{ team_name }} logo" style="height:64px;max-width:90px;background:rgba(255,255,255,0.15);border-radius:12px;padding:8px;">
            <h1 style="margin:0;">{{ team_name }} Players</h1>
        </div>
        <table style="width:100%; border-collapse:collapse; background:{{ team_color }}; border-radius:16px; overflow:hidden;">
            <tbody>
                {% for i in range(0, players|length, 2) %}
                <tr style="border-bottom:1px solid rgba(255,255,255,0.08);">
                    <td style="padding:14px 16px; font-size:1.7vw; color:#ffd700; font-weight:bold; width:50%;">
                        {% if players[i] %}
                            {{ players[i].capnumber }}
                            <span style="font-size:1.5vw; color:#fff; font-weight:normal;">{{ players[i].last_name }}, {{ players[i].first_name }}</span>
                        {% endif %}
                    </td>
                    <td style="padding:14px 16px; font-size:1.7vw; color:#ffd700; font-weight:bold; width:50%;">
                        {% if players[i+1] is defined %}
                            {{ players[i+1].capnumber }} 
                            <span style="font-size:1.5vw; color:#fff; font-weight:normal;">{{ players[i+1].last_name }}, {{ players[i+1].first_name }}</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <script>
            // Fade transition helpers
            function fadeOutAndGo(url) {
                document.body.style.transition = 'opacity 0.5s';
                document.body.style.opacity = 0;
                setTimeout(function() { window.location.href = url; }, 500);
            }
            function fadeOutAndReload() {
                document.body.style.transition = 'opacity 0.5s';
                document.body.style.opacity = 0;
                setTimeout(function() { window.location.reload(); }, 500);
            }

            // Always auto-advance page every 10 seconds, cycling
            setTimeout(function() {
                var nextPage = parseInt('{{ page }}', 10) + 1;
                var totalPages = parseInt('{{ total_pages }}', 10);
                if (nextPage > totalPages) nextPage = 1;
                var path = window.location.pathname;
                if (path.endsWith('/home') || path.endsWith('/away')) {
                    fadeOutAndGo(path + '?page=' + nextPage);
                } else {
                    fadeOutAndGo('/players/{{ team_name }}?page=' + nextPage);
                }
            }, 10000);

            // Poll /state to detect home/away team change and reload if changed
            var path = window.location.pathname;
            var currentTeam = '{{ team_name }}';
            function checkTeamChange() {
                if (path.endsWith('/home') || path.endsWith('/away')) {
                    fetch('/state').then(r => r.json()).then(data => {
                        var expected = path.endsWith('/home') ? data.team1.name : data.team2.name;
                        if (expected !== currentTeam) {
                            fadeOutAndReload();
                        }
                    });
                }
                setTimeout(checkTeamChange, 2000);
            }
            checkTeamChange();

            // Fade in on load
            document.body.style.opacity = 0;
            document.body.style.transition = 'opacity 0.5s';
            window.addEventListener('DOMContentLoaded', function() {
                setTimeout(function() { document.body.style.opacity = 1; }, 10);
            });
        </script>
        </script>
    </div>
</body>
</html>
